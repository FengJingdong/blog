# HTTP

HTTP是超文本传输协议，HTTP是缩写，它的全英文名是HyperText Transfer Protocol。

- 超文本指的是HTML，css，JavaScript和图片等，HTTP的出现是为了接收和发布HTML页面，经过不断的发展也可以用于接收一些音频，视频，文件等内容。

`HTTP协议是用于客户端和服务器端之间的通信`，用于客户端和服务器端之间的通信有HTTP协议和TCP/IP协议族在内的其他众多的协议。
<br>
Client客户端请求Server服务端，Server服务端响应给Client客户端。HTTP是基于客户端/服务端的架构模型，浏览器或其他任何客户端都可以用HTTP协议的，通过URL地址向HTTP的服务器即Web服务器发送所有请求，Web服务器端在接收到请求后会做出反应，响应给对方，就是向客户端回传响应的信息。

## HTTP协议的主要特点

1. 支持客户/服务器模式。
2. 简单快速：客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。
由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。
3. 灵活：HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type加以标记。
4. 无连接：无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。
5. 无状态：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。

这是`HTTP/1.0版的主要缺点`，每个TCP连接只能发送一个请求，发送数据完毕后，连接就关闭了，如果还要请求就必须要新建一个请求连接。

HTTP是一种不保存状态，无状态协议，协议对于发送过来的请求或是响应都不做持久化处理。

HTTP1.1虽然是无状态协议，但是为了实现期望的保持状态功能，于是引入了Cookie技术，有了Cookie，和HTTP协议通信，就可以管理状态了。

>TCP连接的新建成本很高，因为需要客户端和服务器端三次握手。

交流的简单流程：客户端发起连接，客户端发起请求，服务器端响应请求，服务器端关闭连接。

>HTTP、1.1版本是最流行的版本，可以持久连接，TCP连接默认不关闭，可以被多个请求复用，只有在一段时间内，没有请求，就可以自动关闭。

```
// 不用声明：
Connection: keep-alive

// 发送关闭
Connection: close
// 要求服务器关闭TCP连接
```

## HTTP的消息结构

一个请求消息是由请求行，请求头字段，一个空行和消息主体构成。消息主体是响应消息的承载数据。

- 客户端：发送请求
```
GET/HTTP/1.1
Host: hackr.jp
```
- 服务器：发送响应

```
HTTP/1.1 200 OK
Date: Tue, 10 Jul ...
Content.Length: 362
Content.Type: text/html
<html>
```

## HTTP/1.1请求方法：

```
1.GET为获取资源数据
get方法用于请求指定的页面信息，并返回请求消息的主体

2.POST为提交资源数据
post方法用于向指定的资源提交数据

3.PUT为更新资源数据
4.DELETE为删除资源数据
5.HEAD为读取资源的元数据
6.OPTIONS为读取资源多支持的所有请求方法
7.TRACE为回显服务器收到额请求
8.CONNECT为保留将来使用
```

## HTTP状态码

它的重要作用是Web服务器用来告诉客户端，当前的网页请求发生什么事情了，或者是当前web服务器端的响应状态，HTTP状态码是服务器端返回给客户端的。

### 常见的状态码

有200,301,302,304,404,500,403。

- 我们最常见的状态码为200，状态码200表示服务器响应成功，服务器找到了客户端请求的内容，并将内容发送给了客户端。

- 我们程序员有时候也常见的500，状态码500表示程序错误，就是说请求的网页程序本身就报错了。

- 现在的浏览器会对状态码500做出一定的处理，所以在一般情况下会返回一个定制的错误页面。

- 状态码404表示服务器上没有该资源，或者说是服务器上没有找到客户端请求的资源，是最常见的请求错误码。

- 状态码301和状态码302
状态码302表示临时跳转。

url地址a可以向url地址b上跳转，但这并不意味着是永久性的，有可能过短时间就从url地址a跳转到地址c。

而状态码301代表的是永久性的重定向。

- 2xx:

200为请求已经成功，202为服务器已经接受请求，但尚未处理，204为服务器成功处理了请求，但不需要返回如何实体内容。

- 304状态码，被请求的资源内容没有发生更改。

- 400为包含语法错误，无法被服务器解析，403为服务器已经接收请求，但是被拒绝执行，404请求失败。

- 500为服务器内部错误，无法处理请求，502为作为网关或者代理工作的服务器尝试执行请求时，从上游服务器接收到无效响应，504为作为网关或者代理工作的服务器尝试执行请求时，未能及时从上游服务器（URI标识出的服务器，例如HTTP、FTP、LDAP）或者辅助服务器（例如DNS）收到响应

## 常见知识点面试题

>HTTP和HTTPS的区别有哪些？

HTTP是一种超文本传输协议，HTTP是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。 HTTPS比 HTTP多了secure安全性这个概念，实际上， HTTPS并不是一个新的应用层协议，它其实就是HTTP + TLS/SSL协议组合而成，HTTPS可以说就是身披了一层SSL的HTTP。它们最大的区别就是HTTP 在地址栏上的协议是以 http:// 开头，而 HTTPS 在地址栏上的协议是以 https:// 开头。另外，HTTP是未经安全加密的协议，它的传输过程容易被攻击者监听、数据容易被窃取、发送方和接收方容易被伪造；而HTTPS是安全的协议，它通过 密钥交换算法 - 签名算法 - 对称加密算法 - 摘要算法 能够解决上面这些问题。还有，HTTP 的默认端口是80，而HTTPS的默认端口是443。

>HTTP Get和Post区别是什么？

HTTP中包括许多方法，Get和Post是HTTP中最常用的两个方法。get方法一般用于请求，而post方法一般用于表单的提交。get相当于一个是pull/拉的操作，而post相当于是一个push/推的操作。get请求的URL有长度限制，而post请求会把参数和值放在消息体中，对数据长度没有要求。get请求会被浏览器主动cache，而post不会，除非手动设置。get请求在浏览器反复的回退/前进操作是无害的，而post操作会再次提交表单请求。

>请你说一下HTTP常见的请求头

这个问题比较开放，因为 HTTP 请求头有很多，这里只简单举出一个例子。HTTP标头会分为四种，分别是 通用标头、实体标头、请求标头、响应标头。Cache-Control 是一个通用标头，他可以出现在请求标头和响应标头中，Cache-Control 的种类比较多，虽然说这是一个通用标头，但是有一些特性是请求标头具有的，有一些是响应标头才有的。主要大类有 可缓存性、阈值性、 重新验证并重新加载 和其他特性。

>HTTPS的工作原理。

HTTPS的工作原理其实就是SSL/TLS的握手过程。在 TLS 握手期间，Internet 中的通信双方会彼此交换信息，验证密码套件，交换会话密钥。每当用户通过 HTTPS 导航到具体的网站并发送请求时，就会进行 TLS 握手。除此之外，每当其他任何通信使用HTTPS（包括 API 调用和在 HTTPS 上查询 DNS）时，也会发生 TLS 握手。TLS 具体的握手过程会根据所使用的密钥交换算法的类型和双方支持的密码套件而不同。我们以RSA 非对称加密来讨论这个过程。

>完整HTTP请求所经历的7个步骤
```
建立TCP连接
浏览器向服务器发送请求行
浏览器发送请求头
服务器应答
服务器发送应答头
服务器向浏览器发送数据
服务器关闭TCP连接
```

>http的keep-alive

TCP连接在发送后将仍然保持打开状态，浏览器可以继续通过相同的连接发送请求，节省了建立连接所需时间和网络带宽

 

>Ajax请求过程
```
创建XMLHttpRequest对象
设置回调函数
与服务器建立链接，open()
向服务器发送数据，send()
在回调函数中判断响应状态并处理数据
``` 

>常见HTTP状态码

200：请求成功

301：永久性重定向

302：临时重定向

403：请求的对应资源禁止被访问

404：服务器无法找到对应资源

500：服务器内部错误

503：服务器正忙

 

>网页从输入网址到加载完成的过程
```
浏览器输入url
域名解析(DNS解析)，解析获取相应IP地址
浏览器向服务器发起并建立tcp连接
浏览器向服务器发送http请求
服务器接收请求，将数据发送浏览器
浏览器获取文件，解析html源码
生成Dom树，解析css样式，js交互，完成渲染
 ```

>浏览器同源策略

同源策略是指"协议+域名+端口"三者相同

分为两种，DOM 同源策略，XMLHttpRequest 同源策略

 

>跨域方式
```
通过jsonp跨域
document.domain + iframe跨域
location.hash + iframe
window.name + iframe跨域
postMessage跨域
nginx代理跨域
nodejs中间件代理跨域
WebSocket协议跨域
``` 

>网站性能优化
```
减少HTTP请求
利用浏览器缓存
减少DOM操作
首屏加载和按需加载
减少浏览器重排和重绘
js和css文件合并压缩
CSS资源放顶部，JS资源放底部
图片使用png格式
```


## 参考文章

[HTTP的前世今生](https://coolshell.cn/articles/19840.html)

[HTTP API 认证授权术](https://coolshell.cn/articles/19395.html)

[如何免费的让网站启用HTTPS](https://coolshell.cn/articles/18094.html)