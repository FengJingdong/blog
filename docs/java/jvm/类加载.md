## 类加载机制
类装载器就是寻找类的字节码文件，并构造出类在JVM内部表示的对象组件。在Java中，类装载器把一个类装入JVM中，要经过以下步骤：
- 装载：查找和导入Class文件；
- 链接：把类的二进制数据合并到JRE中；
    - 校验：检查载入Class文件数据的正确性,确保Class文件的字节流中包含的信息符合当前虚拟机的要求；
    - 准备：给类的静态变量分配存储空间；
    - 解析：将符号引用转成直接引用；
- 初始化：对类的静态变量，静态代码块执行初始化操作

注意以下几种情况不会执行类初始化：
- 通过子类引用父类的静态字段，只会触发父类的初始化，而不会触发子类的初始化。
- 定义对象数组，不会触发该类的初始化。
- 常量在编译期间会存入调用类的常量池中，本质上并没有直接引用定义常量的类，不会触发定义常量所在的类。
- 通过类名获取Class对象，不会触发类的初始化。
- 通过Class.forName加载指定类时，如果指定参数initialize为false时，也不会触发类初始化，其实这个参数是告诉虚拟机，是否要对类进行初始化。
- 通过ClassLoader默认的loadClass方法，也不会触发初始化动作。
- final变量不会触发此类的初始化，因为在编译阶段就存储在常量池中.

>Java中赋值顺序：

1. 父类的静态变量赋值 
2. 自身的静态变量赋值 
3. 父类成员变量赋值和父类块赋值 
4. 父类构造函数赋值 
5. 自身成员变量赋值和自身块赋值 
6. 自身构造函数赋值

- 类的生命周期是：加载->验证->准备->解析->初始化->使用->卸载，只有在准备阶段和初始化阶段才会涉及类变量的初始化和赋值。
- 类的准备阶段需要做是为类变量分配内存并设置默认值/
- 类的初始化阶段需要做是执行类构造器(类构造器是编译器收集所有静态语句块和类变量的赋值语句按语句在源码中的顺序合并生成类构造器)

### 类加载时机
- 创建类的实例，也就是new一个对象
- 访问某个类或接口的静态变量，或者对该静态变量赋值
- 调用类的静态方法
- 反射（Class.forName("com.mysql.jdbc.driver")）
- 初始化一个类的子类（会首先初始化子类的父类）
- JVM启动时标明的启动类，即文件名和类名相同的那个类

### 卸载

JVM中的Class只有满足以下三个条件，才能被GC回收，也就是该Class被卸载（unload）：

   - 该类所有的实例都已经被GC，也就是JVM中不存在该Class的任何实例。
   - 加载该类的ClassLoader已经被GC。
   - 该类的java.lang.Class 对象没有在任何地方被引用，如不能在任何地方通过反射访问该类的方法 